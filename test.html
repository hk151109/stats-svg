<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stats SVG - GitHub Stats Generator</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  color: white;
  line-height: 1.6;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

.nav {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-bottom: 40px;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border-radius: 15px;
  padding: 15px;
}

.nav-btn {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  padding: 12px 24px;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 16px;
}

.nav-btn:hover, .nav-btn.active {
  background: rgba(255, 255, 255, 0.2);
  transform: translateY(-2px);
}

.page {
  display: none;
  animation: fadeIn 0.5s ease-in;
}

.page.active {
  display: block;
}

.header {
  text-align: center;
  margin-bottom: 40px;
  animation: fadeInDown 1s ease-out;
}

.header h1 {
  font-size: 3rem;
  font-weight: 700;
  margin-bottom: 16px;
  background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

.header p {
  font-size: 1.2rem;
  opacity: 0.9;
  font-weight: 300;
}

.search-section {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  padding: 40px;
  margin-bottom: 50px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
  animation: fadeInUp 1s ease-out 0.3s both;
  width: 100%;
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
}

.input-group {
  display: flex;
  gap: 12px;
  margin-bottom: 20px;
}

.input-wrapper {
  flex: 1;
  position: relative;
}

.input-wrapper input {
  width: 100%;
  padding: 16px 20px;
  font-size: 16px;
  border: 2px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.1);
  color: white;
  outline: none;
  transition: all 0.3s ease;
}

.input-wrapper input::placeholder {
  color: rgba(255, 255, 255, 0.7);
}

.input-wrapper input:focus {
  border-color: #4ecdc4;
  background: rgba(255, 255, 255, 0.2);
  box-shadow: 0 0 20px rgba(78, 205, 196, 0.3);
}

.search-btn {
  background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
  border: none;
  color: white;
  padding: 16px 30px;
  font-size: 16px;
  font-weight: 600;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

.search-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
}

.search-btn:active {
  transform: translateY(0);
}

.loading {
  display: none;
  text-align: center;
  margin: 20px 0;
}

.spinner {
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top: 3px solid #4ecdc4;
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
  margin: 0 auto 10px;
}

.result-section {
  width: 100%;
  display: flex;
  justify-content: center;
  animation: fadeIn 1s ease-out;
}

.stats-container {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 24px;
  padding: 30px;
  box-shadow: 0 12px 40px rgba(0,0,0,0.15);
  max-width: 100%;
  overflow: hidden;
}

.stats-container img {
  display: block;
  max-width: 100%;
  height: auto;
  border-radius: 16px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
  transition: transform 0.3s ease;
}

.stats-container img:hover {
  transform: scale(1.02);
}

.error {
  background: rgba(255, 107, 107, 0.2);
  border: 1px solid rgba(255, 107, 107, 0.4);
  color: #ff6b6b;
  padding: 20px;
  border-radius: 12px;
  margin: 20px 0;
  text-align: center;
  font-weight: 500;
}

.github-icon {
  width: 24px;
  height: 24px;
  margin-right: 8px;
  vertical-align: middle;
}

.info-section {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  padding: 40px;
  margin-bottom: 30px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.info-section h2 {
  color: #4ecdc4;
  margin-bottom: 20px;
  font-size: 1.8rem;
  display: flex;
  align-items: center;
  gap: 10px;
}

.info-section h3 {
  color: #ff6b6b;
  margin: 25px 0 15px 0;
  font-size: 1.3rem;
}

.info-section p, .info-section li {
  margin-bottom: 10px;
  opacity: 0.9;
}

.info-section ul {
  margin-left: 20px;
  margin-bottom: 20px;
}

.info-section a {
  color: #4ecdc4;
  text-decoration: none;
}

.info-section a:hover {
  text-decoration: underline;
}

.code-block {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 8px;
  padding: 15px;
  margin: 15px 0;
  font-family: 'Courier New', monospace;
  overflow-x: auto;
  border-left: 4px solid #4ecdc4;
}

.highlight {
  background: rgba(78, 205, 196, 0.2);
  border-radius: 6px;
  padding: 2px 6px;
  margin: 0 2px;
}

.feature-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.feature-card {
  background: rgba(255, 255, 255, 0.05);
  padding: 20px;
  border-radius: 12px;
  border-left: 4px solid #4ecdc4;
}

.feature-card h4 {
  color: #4ecdc4;
  margin-bottom: 10px;
}

.rank-calculator {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  padding: 30px;
  margin-bottom: 30px;
}

.rank-inputs {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-bottom: 20px;
}

.rank-input {
  display: flex;
  flex-direction: column;
}

.rank-input label {
  margin-bottom: 5px;
  font-weight: 600;
  color: #4ecdc4;
}

.rank-input input[type="number"] {
  padding: 10px;
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 6px;
  background: rgba(255, 255, 255, 0.1);
  color: white;
  outline: none;
}

.rank-input input[type="number"]:focus {
  border-color: #4ecdc4;
}

.rank-input input[type="checkbox"] {
  margin-right: 10px;
  transform: scale(1.2);
}

.rank-result {
  background: rgba(78, 205, 196, 0.2);
  padding: 20px;
  border-radius: 12px;
  text-align: center;
  margin-top: 20px;
}

.rank-level {
  font-size: 2rem;
  font-weight: bold;
  color: #4ecdc4;
}

.rank-percentile {
  font-size: 1.2rem;
  margin-top: 10px;
}

.github-repo-link {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 1000;
  background: linear-gradient(135deg, #24292e 0%, #1a1e22 100%);
  color: white;
  text-decoration: none;
  padding: 15px;
  border-radius: 50%;
  box-shadow: 0 8px 25px rgba(0,0,0,0.3);
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 60px;
  height: 60px;
  backdrop-filter: blur(10px);
  border: 2px solid rgba(255,255,255,0.1);
}

.github-repo-link:hover {
  transform: translateY(-3px) rotate(360deg);
  box-shadow: 0 12px 35px rgba(0,0,0,0.4);
  background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
  border-color: rgba(255,255,255,0.3);
}

.github-repo-link i {
  font-size: 24px;
  transition: all 0.3s ease;
}

.github-repo-link:hover i {
  transform: scale(1.1);
}

@keyframes fadeInDown {
  from {
    opacity: 0;
    transform: translateY(-30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@media (max-width: 768px) {
  .header h1 {
    font-size: 2rem;
  }
  
  .search-section, .info-section {
    padding: 20px;
    margin: 0 10px 30px;
  }
  
  .input-group {
    flex-direction: column;
  }
  
  .nav {
    flex-direction: column;
    gap: 10px;
  }
  
  .rank-inputs {
    grid-template-columns: 1fr;
  }
}
</style>
</head>
<body>
<a href="https://github.com/hk151109/stats-svg" target="_blank" class="github-repo-link" title="View on GitHub">
  <i class="fab fa-github"></i>
</a>

<div class="container">
  <nav class="nav">
    <button class="nav-btn active" onclick="showPage('home', this)">
      <i class="fas fa-home"></i> Home
    </button>
    <button class="nav-btn" onclick="showPage('about', this)">
      <i class="fas fa-info-circle"></i> About
    </button>
    <button class="nav-btn" onclick="showPage('rank-calculator', this)">
      <i class="fas fa-calculator"></i> Rank Calculator
    </button>
  </nav>

  <!-- HOME PAGE -->
  <div id="home" class="page active">
    <div class="header">
      <h1>
        <i class="fa-brands fa-github"></i>
        Stats SVG
        <i class="fa-solid fa-chart-line"></i>
      </h1>
      <p>A highly customizable GitHub stats SVG generator</p>
    </div>

    <div class="search-section">
      <div class="input-group">
        <div class="input-wrapper">
          <input type="text" id="username" placeholder="Enter GitHub username..." maxlength="39">
        </div>
        <button class="search-btn" onclick="showStats()">
          Generate Stats
        </button>
      </div>
      
      <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Fetching your GitHub stats...</p>
      </div>
    </div>

    <div class="result-section" id="result"></div>

    <div class="info-section">
      <h3><i class="fas fa-rocket"></i> Quick Template for Your Profile</h3>
      <p>Once you've tested your stats, add this to your GitHub profile README:</p>
      <div class="code-block">
![GitHub Stats](https://git-stats.harikrishnan.tech/api/github-status?username=YOUR_USERNAME)
      </div>
      <p><strong>Replace <span class="highlight">YOUR_USERNAME</span> with your actual GitHub username</strong></p>
    </div>
  </div>

  <!-- ABOUT PAGE -->
  <div id="about" class="page">
    <div class="header">
      <h1>About Stats SVG</h1>
      <p>Everything you need to know about this project</p>
    </div>

    <div class="info-section">
      <h2><i class="fas fa-star"></i> Features</h2>
      <div class="feature-grid">
        <div class="feature-card">
          <h4><i class="fas fa-clock"></i> Real-time Data</h4>
          <p>Fetches live GitHub user data using the GitHub GraphQL API</p>
        </div>
        <div class="feature-card">
          <h4><i class="fas fa-palette"></i> Highly Customizable</h4>
          <p>Generate SVG images with custom color schemes, configurations, and animated elements</p>
        </div>
        <div class="feature-card">
          <h4><i class="fas fa-chart-bar"></i> Comprehensive Metrics</h4>
          <p>Displays commits, language usage, repositories, stars, and more</p>
        </div>
        <div class="feature-card">
          <h4><i class="fas fa-sync-alt"></i> Consistent Algorithm</h4>
          <p>Uses the same ranking algorithm as anuraghazra/github-readme-stats for standardized results</p>
        </div>
        <div class="feature-card">
          <h4><i class="fas fa-bolt"></i> Fast & Lightweight</h4>
          <p>Optimized SVG generation for quick loading</p>
        </div>
        <div class="feature-card">
          <h4><i class="fas fa-rainbow"></i> Multiple Themes</h4>
          <p>Support for various color themes and styles</p>
        </div>
      </div>
    </div>

    <div class="info-section">
      <h2><i class="fas fa-server"></i> Deployment</h2>
      <p>Since the GitHub API only allows 5k requests per hour, the public API provided by this repo could possibly hit the rate limiter. You can host your own instance of this repo on Vercel to avoid rate limiting issues.</p>
      
      <h3><i class="fas fa-rocket"></i> Manual Deployment</h3>
      <h4>1. Fork and Prepare the Repository</h4>
      <ul>
        <li><strong>Fork this repository</strong> to your GitHub account</li>
        <li><strong>Create a Personal Access Token (PAT)</strong>
          <ul>
            <li>Set the token name (e.g., "stats-svg")</li>
            <li>Select scopes: <span class="highlight">repo</span> and <span class="highlight">user</span></li>
            <li>Copy the generated token (you won't see it again so save it!)</li>
          </ul>
        </li>
      </ul>

      <h4>2. Deploy to Vercel</h4>
      <ul>
        <li>Visit <a href="https://vercel.com/" target="_blank">Vercel</a></li>
        <li>Sign up/Log in with your GitHub account</li>
        <li>From your Vercel dashboard:
          <ul>
            <li>Click <span class="highlight">Add New...</span> → <span class="highlight">Project</span></li>
            <li>Select the forked repository</li>
            <li>Click <span class="highlight">Import</span></li>
          </ul>
        </li>
      </ul>

      <h4>3. Configure Environment Variables</h4>
      <ul>
        <li>In the project configuration screen:
          <ul>
            <li>Expand the <span class="highlight">Environment Variables</span> section</li>
            <li>Add a new variable:
              <ul>
                <li><strong>Name</strong>: <span class="highlight">GITHUB_TOKEN</span></li>
                <li><strong>Value</strong>: Your GitHub PAT from step 1</li>
              </ul>
            </li>
          </ul>
        </li>
        <li>Click <span class="highlight">Deploy</span></li>
      </ul>

      <h4>4. Using Your Instance</h4>
      <p>Once deployed, Vercel will provide you with a domain (e.g., <span class="highlight">your-project.vercel.app</span>)</p>
      <div class="code-block">
https://your-project.vercel.app/api/github-status?username=YOUR_GITHUB_USERNAME
      </div>
    </div>

    <div class="info-section">
      <h2><i class="fas fa-palette"></i> Customization Options</h2>
      <p>You can customize the appearance of the SVG by modifying query parameters of the <span class="highlight">config.js</span> file.</p>
    </div>

    <div class="info-section">
      <h2><i class="fas fa-hands-helping"></i> Contributing</h2>
      <p>Contributions are welcome! Please feel free to submit a Pull Request. For major changes, please open an issue first to discuss what you would like to change.</p>
    </div>
  </div>

  <!-- RANK CALCULATOR PAGE -->
  <div id="rank-calculator" class="page">
    <div class="header">
      <h1>Rank Calculator</h1>
      <p>Understanding how GitHub user ranks are calculated</p>
    </div>

    <div class="info-section">
      <h2><i class="fas fa-calculator"></i> How Ranking Works</h2>
      <p>The ranking algorithm uses a weighted combination of various GitHub metrics to calculate a user's percentile rank. Each metric is normalized using statistical functions and then weighted according to its importance.</p>
      
      <h3><i class="fas fa-weight-hanging"></i> Metric Weights & Medians</h3>
      <div class="feature-grid">
        <div class="feature-card">
          <h4>Commits</h4>
          <p><strong>Weight:</strong> 2<br><strong>Median:</strong> 250 (or 1000 if all commits included)</p>
        </div>
        <div class="feature-card">
          <h4>Pull Requests</h4>
          <p><strong>Weight:</strong> 3<br><strong>Median:</strong> 50</p>
        </div>
        <div class="feature-card">
          <h4>Stars</h4>
          <p><strong>Weight:</strong> 4<br><strong>Median:</strong> 50</p>
        </div>
        <div class="feature-card">
          <h4>Issues</h4>
          <p><strong>Weight:</strong> 1<br><strong>Median:</strong> 25</p>
        </div>
        <div class="feature-card">
          <h4>Reviews</h4>
          <p><strong>Weight:</strong> 1<br><strong>Median:</strong> 2</p>
        </div>
        <div class="feature-card">
          <h4>Followers</h4>
          <p><strong>Weight:</strong> 1<br><strong>Median:</strong> 10</p>
        </div>
        <div class="feature-card">
          <h4>Repositories</h4>
          <p><strong>Weight:</strong> 1<br><strong>Median:</strong> 3</p>
        </div>
      </div>
    </div>

    <div class="rank-calculator">
      <h2><i class="fas fa-calculator"></i> Calculate Your Rank</h2>
      <p>Enter your GitHub stats to see what rank you would get:</p>
      
      <div class="rank-inputs">
        <div class="rank-input">
          <label for="commits">Commits:</label>
          <input type="number" id="commits" value="0" min="0" oninput="calculateRank()">
        </div>
        <div class="rank-input">
          <label for="prs">Pull Requests:</label>
          <input type="number" id="prs" value="0" min="0" oninput="calculateRank()">
        </div>
        <div class="rank-input">
          <label for="issues">Issues:</label>
          <input type="number" id="issues" value="0" min="0" oninput="calculateRank()">
        </div>
        <div class="rank-input">
          <label for="reviews">Reviews:</label>
          <input type="number" id="reviews" value="0" min="0" oninput="calculateRank()">
        </div>
        <div class="rank-input">
          <label for="repos">Repositories:</label>
          <input type="number" id="repos" value="0" min="0" oninput="calculateRank()">
        </div>
        <div class="rank-input">
          <label for="stars">Stars:</label>
          <input type="number" id="stars" value="0" min="0" oninput="calculateRank()">
        </div>
        <div class="rank-input">
          <label for="followers">Followers:</label>
          <input type="number" id="followers" value="0" min="0" oninput="calculateRank()">
        </div>
      </div>

      <div class="rank-input" style="margin-bottom: 20px;">
        <label>
          <input type="checkbox" id="allCommits" onchange="calculateRank()">
          Include all commits (changes median from 250 to 1000)
        </label>
      </div>

      <div class="rank-result" id="rankResult">
        <div class="rank-level">Rank: C</div>
        <div class="rank-percentile">Percentile: 0.0%</div>
      </div>
    </div>

    <div class="info-section">
      <h2><i class="fas fa-code"></i> Algorithm Implementation</h2>
      <p>The ranking calculation uses two key statistical functions:</p>
      
      <h3>Exponential CDF</h3>
      <div class="code-block">
function exponential_cdf(x) {
  return 1 - 2 ** -x;
}
      </div>
      <p>Used for: Commits, Pull Requests, Issues, and Reviews</p>

      <h3>Log Normal CDF</h3>
      <div class="code-block">
function log_normal_cdf(x) {
  // approximation
  return x / (1 + x);
}
      </div>
      <p>Used for: Stars, Followers, and Repositories</p>

      <h3>Rank Levels</h3>
      <p>Based on percentile thresholds:</p>
      <ul>
        <li><strong>A++</strong>: Top 1%</li>
        <li><strong>A+</strong>: Top 12.5%</li>
        <li><strong>A</strong>: Top 25%</li>
        <li><strong>A-</strong>: Top 37.5%</li>
        <li><strong>B+</strong>: Top 50%</li>
        <li><strong>B</strong>: Top 62.5%</li>
        <li><strong>B-</strong>: Top 75%</li>
        <li><strong>C+</strong>: Top 87.5%</li>
        <li><strong>C</strong>: Bottom 12.5%</li>
      </ul>
    </div>
  </div>
</div>

<script>
// Navigation function
function showPage(pageId, button) {
  // Hide all pages
  document.querySelectorAll('.page').forEach(page => {
    page.classList.remove('active');
  });
  
  // Remove active class from all nav buttons
  document.querySelectorAll('.nav-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  
  // Show selected page
  document.getElementById(pageId).classList.add('active');
  
  // Add active class to clicked button
  button.classList.add('active');
}

// Stats generation function
function showStats() {
  const username = document.getElementById('username').value.trim();
  const resultDiv = document.getElementById('result');
  const loadingDiv = document.getElementById('loading');
  
  if (!username) {
    resultDiv.innerHTML = '<div class="error">Please enter a GitHub username</div>';
    return;
  }
  
  // Validate username format (basic GitHub username rules)
  const usernameRegex = /^[a-z\d](?:[a-z\d]|-(?=[a-z\d])){0,38}$/i;
  if (!usernameRegex.test(username)) {
    resultDiv.innerHTML = '<div class="error">Please enter a valid GitHub username</div>';
    return;
  }
  
  // Show loading state
  loadingDiv.style.display = 'block';
  resultDiv.innerHTML = '';
  
  // Create image element
  const img = new Image();
  const imgUrl = `https://git-stats.harikrishnan.tech/api/github-status?username=${username}`;
  
  img.onload = function() {
    loadingDiv.style.display = 'none';
    resultDiv.innerHTML = `
      <div class="stats-container">
        <img src="${imgUrl}" alt="GitHub Stats for ${username}" loading="lazy">
      </div>
    `;
  };
  
  img.onerror = function() {
    loadingDiv.style.display = 'none';
    resultDiv.innerHTML = `
      <div class="error">
        Unable to load stats for "${username}". Please check if the username exists and try again.
      </div>
    `;
  };
  
  // Start loading the image
  img.src = imgUrl;
}

// Rank calculation functions
function exponential_cdf(x) {
  return 1 - Math.pow(2, -x);
}

function log_normal_cdf(x) {
  return x / (1 + x);
}

function calculateGitHubRank({
  all_commits,
  commits = 0,
  prs = 0,
  issues = 0,
  reviews = 0,
  repos = 0,
  stars = 0,
  followers = 0,
}) {
  const COMMITS_MEDIAN = all_commits ? 1000 : 250;
  const COMMITS_WEIGHT = 2;
  const PRS_MEDIAN = 50;
  const PRS_WEIGHT = 3;
  const ISSUES_MEDIAN = 25;
  const ISSUES_WEIGHT = 1;
  const REVIEWS_MEDIAN = 2;
  const REVIEWS_WEIGHT = 1;
  const STARS_MEDIAN = 50;
  const STARS_WEIGHT = 4;
  const FOLLOWERS_MEDIAN = 10;
  const FOLLOWERS_WEIGHT = 1;
  const REPOS_MEDIAN = 3;
  const REPOS_WEIGHT = 1;

  const TOTAL_WEIGHT =
    COMMITS_WEIGHT +
    PRS_WEIGHT +
    ISSUES_WEIGHT +
    REVIEWS_WEIGHT +
    STARS_WEIGHT +
    FOLLOWERS_WEIGHT +
    REPOS_WEIGHT;

  const THRESHOLDS = [1, 12.5, 25, 37.5, 50, 62.5, 75, 87.5, 100];
  const LEVELS = ["A++", "A+", "A", "A-", "B+", "B", "B-", "C+", "C"];

  const rank =
    1 -
    (COMMITS_WEIGHT * exponential_cdf(commits / COMMITS_MEDIAN) +
      PRS_WEIGHT * exponential_cdf(prs / PRS_MEDIAN) +
      ISSUES_WEIGHT * exponential_cdf(issues / ISSUES_MEDIAN) +
      REVIEWS_WEIGHT * exponential_cdf(reviews / REVIEWS_MEDIAN) +
      STARS_WEIGHT * log_normal_cdf(stars / STARS_MEDIAN) +
      FOLLOWERS_WEIGHT * log_normal_cdf(followers / FOLLOWERS_MEDIAN) +
      REPOS_WEIGHT * log_normal_cdf(repos / REPOS_MEDIAN)) /
      TOTAL_WEIGHT;

  const level = LEVELS[THRESHOLDS.findIndex((t) => rank * 100 <= t)];

  return { level, percentile: rank * 100 };
}

function calculateRank() {
  const commits = parseInt(document.getElementById('commits').value) || 0;
  const prs = parseInt(document.getElementById('prs').value) || 0;
  const issues = parseInt(document.getElementById('issues').value) || 0;
  const reviews = parseInt(document.getElementById('reviews').value) || 0;
  const repos = parseInt(document.getElementById('repos').value) || 0;
  const stars = parseInt(document.getElementById('stars').value) || 0;
  const followers = parseInt(document.getElementById('followers').value) || 0;
  const allCommits = document.getElementById('allCommits').checked;

  const result = calculateGitHubRank({
    all_commits: allCommits,
    commits,
    prs,
    issues,
    reviews,
    repos,
    stars,
    followers,
  });

  document.getElementById('rankResult').innerHTML = `
    <div class="rank-level">Rank: ${result.level}</div>
    <div class="rank-percentile">Percentile: ${result.percentile.toFixed(1)}%</div>
  `;
}

// Allow Enter key to trigger search
document.getElementById('username').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    showStats();
  }
});

// Auto-focus on input when page loads
window.addEventListener('load', function() {
  document.getElementById('username').focus();
  calculateRank(); // Initialize rank calculator
});
</script>
</body>
</html>